

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GNN 核心层 &mdash; HamGNN 2.0 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8ba3eb92"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/translations.js?v=beaddf03"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="模型通用组件" href="model_components.html" />
    <link rel="prev" title="模型顶层结构" href="model_structure.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            HamGNN
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">API 文档</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="main_entry.html">主程序入口</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_structure.html">模型顶层结构</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">GNN 核心层</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-HamGNN_v_2_0.models.HamGNN.net">HamGNN 网络 (<cite>net.py</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.num_types"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.num_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.cutoff"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.cutoff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.num_layers"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.num_layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.irreps_node_features"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.irreps_node_features</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.radial_basis_functions"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.radial_basis_functions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.atomic_embedding"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.atomic_embedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.spharm_edges"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.spharm_edges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.radial_basis"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.radial_basis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.pair_embedding"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.pair_embedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.chemical_embedding"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.chemical_embedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.convolutions"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.convolutions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.corr_products"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.corr_products</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.pair_interactions"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.pair_interactions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.forward"><code class="docutils literal notranslate"><span class="pre">HamGNNConvE3.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.nao_max"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.nao_max</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.ham_type"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.ham_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.ham_only"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.ham_only</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.soc_switch"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.soc_switch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.spin_constrained"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.spin_constrained</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.ham_irreps"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.ham_irreps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.onsitenet_h"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.onsitenet_h</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.offsitenet_h"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.offsitenet_h</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cg_cal"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.cg_cal</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.J_merge"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.J_merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.K_merge"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.K_merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cal_band_energy"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.cal_band_energy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cal_band_energy_debug"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.cal_band_energy_debug()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cal_band_energy_soc"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.cal_band_energy_soc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cat_onsite_and_offsite"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.cat_onsite_and_offsite()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.change_index"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.change_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.construct_Hsoc"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.construct_Hsoc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.convert_to_mole_Ham"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.convert_to_mole_Ham()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.forward"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.get_basis_definition"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.get_basis_definition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.get_unique_cell_shift_and_cell_shift_indices"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.get_unique_cell_shift_and_cell_shift_indices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.index_cells"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.index_cells()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.mask_Ham"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.mask_Ham()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.mask_tensor_builder"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.mask_tensor_builder()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.mask_tensor_builder_col"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.mask_tensor_builder_col()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.mask_tensor_builder_soc"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.mask_tensor_builder_soc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.matrix_0rank_merge"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.matrix_0rank_merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.matrix_2rank_merge"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.matrix_2rank_merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.matrix_merge"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.matrix_merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.reduce"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.reduce()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.symmetrize_Hoff"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_Hoff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.symmetrize_Hoff_soc"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_Hoff_soc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.symmetrize_Hon"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_Hon()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.symmetrize_Hon_soc"><code class="docutils literal notranslate"><span class="pre">HamGNNPlusPlusOut.symmetrize_Hon_soc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.num_types"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.num_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.cutoff"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.cutoff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.num_layers"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.num_layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.irreps_node_features"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.irreps_node_features</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.num_heads"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.num_heads</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.radial_basis_functions"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.radial_basis_functions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.atomic_embedding"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.atomic_embedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.spharm_edges"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.spharm_edges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.radial_basis"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.radial_basis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.pair_embedding"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.pair_embedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.chemical_embedding"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.chemical_embedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.orb_transformers"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.orb_transformers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.corr_products"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.corr_products</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.pair_interactions"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.pair_interactions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.forward"><code class="docutils literal notranslate"><span class="pre">HamGNNTransformer.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-HamGNN_v_2_0.models.HamGNN.BaseModel">基础模型 (<cite>BaseModel.py</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel"><code class="docutils literal notranslate"><span class="pre">BaseModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.radius_type"><code class="docutils literal notranslate"><span class="pre">BaseModel.radius_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.radius_scale"><code class="docutils literal notranslate"><span class="pre">BaseModel.radius_scale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.forward"><code class="docutils literal notranslate"><span class="pre">BaseModel.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.generate_graph"><code class="docutils literal notranslate"><span class="pre">BaseModel.generate_graph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.num_params"><code class="docutils literal notranslate"><span class="pre">BaseModel.num_params</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.find_matching_columns_of_A_in_B"><code class="docutils literal notranslate"><span class="pre">find_matching_columns_of_A_in_B()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.get_radii_from_atomic_numbers"><code class="docutils literal notranslate"><span class="pre">get_radii_from_atomic_numbers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.neighbor_list_and_relative_vec"><code class="docutils literal notranslate"><span class="pre">neighbor_list_and_relative_vec()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-HamGNN_v_2_0.models.HamGNN.Attention_kan">注意力与 KAN 层 (<cite>Attention_kan.py</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionAggregation"><code class="docutils literal notranslate"><span class="pre">AttentionAggregation</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionAggregation.forward"><code class="docutils literal notranslate"><span class="pre">AttentionAggregation.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionAggregationV2"><code class="docutils literal notranslate"><span class="pre">AttentionAggregationV2</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionAggregationV2.forward"><code class="docutils literal notranslate"><span class="pre">AttentionAggregationV2.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3"><code class="docutils literal notranslate"><span class="pre">AttentionBlockE3</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.create_linear"><code class="docutils literal notranslate"><span class="pre">AttentionBlockE3.create_linear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.create_nonlinearity"><code class="docutils literal notranslate"><span class="pre">AttentionBlockE3.create_nonlinearity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.create_tensor_product"><code class="docutils literal notranslate"><span class="pre">AttentionBlockE3.create_tensor_product()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.forward"><code class="docutils literal notranslate"><span class="pre">AttentionBlockE3.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.init_weight_generator"><code class="docutils literal notranslate"><span class="pre">AttentionBlockE3.init_weight_generator()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionHeadsToVector"><code class="docutils literal notranslate"><span class="pre">AttentionHeadsToVector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionHeadsToVector.irreps_head"><code class="docutils literal notranslate"><span class="pre">AttentionHeadsToVector.irreps_head</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionHeadsToVector.head_sizes"><code class="docutils literal notranslate"><span class="pre">AttentionHeadsToVector.head_sizes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionHeadsToVector.forward"><code class="docutils literal notranslate"><span class="pre">AttentionHeadsToVector.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ClebschGordanCoefficients"><code class="docutils literal notranslate"><span class="pre">ClebschGordanCoefficients</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ClebschGordanCoefficients.forward"><code class="docutils literal notranslate"><span class="pre">ClebschGordanCoefficients.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ConcatenatedIrrepsTensorProduct"><code class="docutils literal notranslate"><span class="pre">ConcatenatedIrrepsTensorProduct</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ConcatenatedIrrepsTensorProduct.forward"><code class="docutils literal notranslate"><span class="pre">ConcatenatedIrrepsTensorProduct.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ConvBlockE3"><code class="docutils literal notranslate"><span class="pre">ConvBlockE3</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ConvBlockE3.create_linear"><code class="docutils literal notranslate"><span class="pre">ConvBlockE3.create_linear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ConvBlockE3.forward"><code class="docutils literal notranslate"><span class="pre">ConvBlockE3.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.CorrProductBlock"><code class="docutils literal notranslate"><span class="pre">CorrProductBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.CorrProductBlock.forward"><code class="docutils literal notranslate"><span class="pre">CorrProductBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.EdgeScalarEmbedding"><code class="docutils literal notranslate"><span class="pre">EdgeScalarEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.EdgeScalarEmbedding.forward"><code class="docutils literal notranslate"><span class="pre">EdgeScalarEmbedding.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.HamLayer"><code class="docutils literal notranslate"><span class="pre">HamLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.HamLayer.forward"><code class="docutils literal notranslate"><span class="pre">HamLayer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.LinearScaleWithWeights"><code class="docutils literal notranslate"><span class="pre">LinearScaleWithWeights</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.LinearScaleWithWeights.forward"><code class="docutils literal notranslate"><span class="pre">LinearScaleWithWeights.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.LocalEnvironmentEmbedding"><code class="docutils literal notranslate"><span class="pre">LocalEnvironmentEmbedding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.LocalEnvironmentEmbedding.forward"><code class="docutils literal notranslate"><span class="pre">LocalEnvironmentEmbedding.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.MessagePackBlock"><code class="docutils literal notranslate"><span class="pre">MessagePackBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.MessagePackBlock.forward"><code class="docutils literal notranslate"><span class="pre">MessagePackBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.MessagePackBlockV2"><code class="docutils literal notranslate"><span class="pre">MessagePackBlockV2</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.MessagePackBlockV2.forward"><code class="docutils literal notranslate"><span class="pre">MessagePackBlockV2.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.OverlapExpand"><code class="docutils literal notranslate"><span class="pre">OverlapExpand</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.OverlapExpand.forward"><code class="docutils literal notranslate"><span class="pre">OverlapExpand.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionBlock"><code class="docutils literal notranslate"><span class="pre">PairInteractionBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionBlock.create_linear"><code class="docutils literal notranslate"><span class="pre">PairInteractionBlock.create_linear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionBlock.forward"><code class="docutils literal notranslate"><span class="pre">PairInteractionBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock.create_linear"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock.create_linear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock.create_tensor_product"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock.create_tensor_product()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock.forward"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock.init_weight_generator"><code class="docutils literal notranslate"><span class="pre">PairInteractionEmbeddingBlock.init_weight_generator()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.RadialBasisEdgeEncoding"><code class="docutils literal notranslate"><span class="pre">RadialBasisEdgeEncoding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.RadialBasisEdgeEncoding.out_field"><code class="docutils literal notranslate"><span class="pre">RadialBasisEdgeEncoding.out_field</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.RadialBasisEdgeEncoding.forward"><code class="docutils literal notranslate"><span class="pre">RadialBasisEdgeEncoding.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ResidualBlock"><code class="docutils literal notranslate"><span class="pre">ResidualBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ResidualBlock.create_nonlinearity"><code class="docutils literal notranslate"><span class="pre">ResidualBlock.create_nonlinearity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ResidualBlock.forward"><code class="docutils literal notranslate"><span class="pre">ResidualBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.SoftUnitStepCutoff"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.SoftUnitStepCutoff.cutoff"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.cutoff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.SoftUnitStepCutoff.cut_param"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.cut_param</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.SoftUnitStepCutoff.forward"><code class="docutils literal notranslate"><span class="pre">SoftUnitStepCutoff.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorExpansion"><code class="docutils literal notranslate"><span class="pre">TensorExpansion</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorExpansion.forward"><code class="docutils literal notranslate"><span class="pre">TensorExpansion.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorProductWithMemoryOptimizationWithWeight"><code class="docutils literal notranslate"><span class="pre">TensorProductWithMemoryOptimizationWithWeight</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorProductWithMemoryOptimizationWithWeight.forward"><code class="docutils literal notranslate"><span class="pre">TensorProductWithMemoryOptimizationWithWeight.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorProductWithScalarComponents"><code class="docutils literal notranslate"><span class="pre">TensorProductWithScalarComponents</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorProductWithScalarComponents.forward"><code class="docutils literal notranslate"><span class="pre">TensorProductWithScalarComponents.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.VectorToAttentionHeads"><code class="docutils literal notranslate"><span class="pre">VectorToAttentionHeads</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.VectorToAttentionHeads.forward"><code class="docutils literal notranslate"><span class="pre">VectorToAttentionHeads.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.count_neighbors_per_node"><code class="docutils literal notranslate"><span class="pre">count_neighbors_per_node()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.extract_scalar_irreps"><code class="docutils literal notranslate"><span class="pre">extract_scalar_irreps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.filter_and_split_irreps"><code class="docutils literal notranslate"><span class="pre">filter_and_split_irreps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.irreps2gate"><code class="docutils literal notranslate"><span class="pre">irreps2gate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.scale_irreps"><code class="docutils literal notranslate"><span class="pre">scale_irreps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-HamGNN_v_2_0.models.HamGNN.wigner">物理工具 (<cite>wigner.py</cite>, <cite>clebsch_gordan.py</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.wigner.wigner"><code class="docutils literal notranslate"><span class="pre">wigner()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.clebsch_gordan.ClebschGordan"><code class="docutils literal notranslate"><span class="pre">ClebschGordan</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.clebsch_gordan.ClebschGordan.forward"><code class="docutils literal notranslate"><span class="pre">ClebschGordan.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model_components.html">模型通用组件</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_processing.html">数据处理与输入</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">通用工具函数</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HamGNN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">GNN 核心层</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/gnn_core.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gnn">
<h1>GNN 核心层<a class="headerlink" href="#gnn" title="Link to this heading"></a></h1>
<p>本部分包含 HamGNN 的核心等变网络层。</p>
<section id="module-HamGNN_v_2_0.models.HamGNN.net">
<span id="hamgnn-net-py"></span><h2>HamGNN 网络 (<cite>net.py</cite>)<a class="headerlink" href="#module-HamGNN_v_2_0.models.HamGNN.net" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.net.</span></span><span class="sig-name descname"><span class="pre">HamGNNConvE3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNConvE3"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3" title="Link to this definition"></a></dt>
<dd><p>基于 E(3) 等变图卷积的 HamGNN 模型。</p>
<p>该模型通过堆叠多个等变卷积层来学习原子及其相互作用的表示。
每一层都会更新原子（节点）和原子对（边）的特征，同时严格保持在旋转下的等变性。
最终输出节点和边的等变特征，用于后续的物理属性预测。</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.num_types">
<span class="sig-name descname"><span class="pre">num_types</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.num_types" title="Link to this definition"></a></dt>
<dd><p>系统中原子种类的数量。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.cutoff" title="Link to this definition"></a></dt>
<dd><p>径向截断半径。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="（在 Python v3.13）">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.num_layers">
<span class="sig-name descname"><span class="pre">num_layers</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.num_layers" title="Link to this definition"></a></dt>
<dd><p>等变卷积层的数量。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.irreps_node_features">
<span class="sig-name descname"><span class="pre">irreps_node_features</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.irreps_node_features" title="Link to this definition"></a></dt>
<dd><p>节点特征的不可约表示。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>o3.Irreps</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.radial_basis_functions">
<span class="sig-name descname"><span class="pre">radial_basis_functions</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.radial_basis_functions" title="Link to this definition"></a></dt>
<dd><p>径向基函数模块。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.atomic_embedding">
<span class="sig-name descname"><span class="pre">atomic_embedding</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.atomic_embedding" title="Link to this definition"></a></dt>
<dd><p>将原子种类转换为独热编码的模块。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.spharm_edges">
<span class="sig-name descname"><span class="pre">spharm_edges</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.spharm_edges" title="Link to this definition"></a></dt>
<dd><p>计算边向量的球谐函数的模块。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.radial_basis">
<span class="sig-name descname"><span class="pre">radial_basis</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.radial_basis" title="Link to this definition"></a></dt>
<dd><p>编码边长度的径向基函数模块。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.pair_embedding">
<span class="sig-name descname"><span class="pre">pair_embedding</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.pair_embedding" title="Link to this definition"></a></dt>
<dd><p>嵌入原子对相互作用的初始特征。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.chemical_embedding">
<span class="sig-name descname"><span class="pre">chemical_embedding</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.chemical_embedding" title="Link to this definition"></a></dt>
<dd><p>将独热编码嵌入到初始节点特征中。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.convolutions">
<span class="sig-name descname"><span class="pre">convolutions</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.convolutions" title="Link to this definition"></a></dt>
<dd><p>等变卷积层列表。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ModuleList</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.corr_products">
<span class="sig-name descname"><span class="pre">corr_products</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.corr_products" title="Link to this definition"></a></dt>
<dd><p>（可选）相关性乘积层列表。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ModuleList</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.pair_interactions">
<span class="sig-name descname"><span class="pre">pair_interactions</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.pair_interactions" title="Link to this definition"></a></dt>
<dd><p>原子对相互作用层列表。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ModuleList</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNConvE3.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNConvE3.forward" title="Link to this definition"></a></dt>
<dd><p>执行模型的前向传播。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data</em><em> or </em><em>EasyDict</em>) – 输入的图数据对象，遵循 PyG 或 Nequip 的数据格式。
需要包含 <cite>pos</cite>, <cite>z</cite>, <cite>edge_index</cite> 等原子结构信息。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>一个包含最终节点和边等变特征的字典。
- ‘node_attr’: 节点的等变特征张量。
- ‘edge_attr’: 边的等变特征张量。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>EasyDict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.net.</span></span><span class="sig-name descname"><span class="pre">HamGNNPlusPlusOut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_in_edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_forces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ham_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'openmx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ham_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetrize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_triplet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculate_band_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_num_control</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soc_switch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_reciprocal_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_H0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soc_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'so3'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_constrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_learned_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minMagneticMoment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collinear_spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_point_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_H_nonsoc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_nonzero_mask_tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut" title="Link to this definition"></a></dt>
<dd><p>HamGNN 的输出模块，用于构建物理哈密顿量并计算相关属性。</p>
<p>这个模块接收图神经网络编码的等变特征，并利用这些特征作为系数，
通过 Clebsch-Gordan 张量积将它们组合成完整的哈密顿量 (H) 和重叠矩阵 (S)。
它能够处理多种 DFT 软件（如 OpenMX, SIESTA, ABACUS）的基组，支持自旋轨道耦合（SOC）、
自旋约束计算，并能最终求解能带结构。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>这个类的实现非常复杂，因为它紧密地耦合了物理学（量子化学、固体物理）
和 E(3) 等变神经网络的数学原理。</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.nao_max">
<span class="sig-name descname"><span class="pre">nao_max</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.nao_max" title="Link to this definition"></a></dt>
<dd><p>预设的最大原子轨道数。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.ham_type">
<span class="sig-name descname"><span class="pre">ham_type</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.ham_type" title="Link to this definition"></a></dt>
<dd><p>使用的 DFT 基组类型 (例如 ‘openmx’)。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.13）">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.ham_only">
<span class="sig-name descname"><span class="pre">ham_only</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.ham_only" title="Link to this definition"></a></dt>
<dd><p>如果为 True，则只计算哈密顿量，不计算重叠矩阵。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.13）">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.soc_switch">
<span class="sig-name descname"><span class="pre">soc_switch</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.soc_switch" title="Link to this definition"></a></dt>
<dd><p>是否启用自旋轨道耦合计算。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.13）">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.spin_constrained">
<span class="sig-name descname"><span class="pre">spin_constrained</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.spin_constrained" title="Link to this definition"></a></dt>
<dd><p>是否进行自旋约束计算。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.13）">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.ham_irreps">
<span class="sig-name descname"><span class="pre">ham_irreps</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.ham_irreps" title="Link to this definition"></a></dt>
<dd><p>哈密顿量/重叠矩阵块的不可约表示。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>o3.Irreps</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.onsitenet_h">
<span class="sig-name descname"><span class="pre">onsitenet_h</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.onsitenet_h" title="Link to this definition"></a></dt>
<dd><p>用于从节点特征预测 onsite 哈密顿量块的网络。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.offsitenet_h">
<span class="sig-name descname"><span class="pre">offsitenet_h</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.offsitenet_h" title="Link to this definition"></a></dt>
<dd><p>用于从边特征预测 offsite 哈密顿量块的网络。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cg_cal">
<span class="sig-name descname"><span class="pre">cg_cal</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cg_cal" title="Link to this definition"></a></dt>
<dd><p>用于计算 Clebsch-Gordan 系数的工具。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ClebschGordanCoefficients" title="HamGNN_v_2_0.models.HamGNN.Attention_kan.ClebschGordanCoefficients">ClebschGordanCoefficients</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.J_merge">
<span class="sig-name descname"><span class="pre">J_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lagrange</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.J_merge"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.J_merge" title="Link to this definition"></a></dt>
<dd><p>将拉格朗日乘子（交换场）合并成完整的交换相互作用矩阵 J。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lagrange</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 神经网络预测的交换场系数。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>交换相互作用矩阵 J。
如果 <cite>soc_switch</cite> 为 True, 形状为 <cite>(N_batch, nao_max, nao_max, 3, 3)</cite>。
否则，形状为 <cite>(N_batch, nao_max, nao_max)</cite>。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.K_merge">
<span class="sig-name descname"><span class="pre">K_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lagrange</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.K_merge"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.K_merge" title="Link to this definition"></a></dt>
<dd><p>将拉格朗日乘子合并成四阶相互作用矩阵 K。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lagrange</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 神经网络预测的四阶项系数。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>四阶相互作用矩阵 K，形状 <cite>(N_batch, nao_max, nao_max)</cite>。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cal_band_energy">
<span class="sig-name descname"><span class="pre">cal_band_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Hon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_reciprocal_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.cal_band_energy"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cal_band_energy" title="Link to this definition"></a></dt>
<dd><p>计算能带结构（非调试的正式版本）。</p>
<p>此函数通过给定的 onsite 和 offsite 矩阵块，为一批晶体构建 k 点依赖的哈密顿量
和重叠矩阵，然后通过求解广义本征值问题来计算能带结构。
该过程与 <cite>cal_band_energy_debug</cite> 类似，但流程更精简，不涉及对预计算 <cite>Son</cite>, <cite>Soff</cite> 的依赖。</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>当前实现主要针对 <cite>openmx</cite> 类型的哈密顿量。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Hon</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 批处理中所有原子/轨道的 Onsite 矩阵块，形状通常为 <cite>(N_nodes, nao_max*nao_max)</cite>。</p></li>
<li><p><strong>Hoff</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 批处理中所有边的 Offsite 矩阵块，形状通常为 <cite>(N_edges, nao_max*nao_max)</cite>。</p></li>
<li><p><strong>data</strong> (<em>Data</em>) – PyG 图数据对象，包含原子结构、k点等信息。</p></li>
<li><p><strong>export_reciprocal_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.13）"><em>bool</em></a><em>, </em><em>optional</em>) – 如果为 True，则额外返回倒易空间中的
哈密顿量 <cite>HK</cite>、重叠矩阵 <cite>SK</cite>、<cite>SK`的导数`dSK</cite> 和波函数。默认为 <cite>False</cite>。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>如果 <cite>export_reciprocal_values</cite> 为 <cite>False</cite>，返回 <cite>(band_energy, wavefunction, gap, H_sym)</cite>。
如果 <cite>export_reciprocal_values</cite> 为 <cite>True</cite>，返回 <cite>(band_energy, wavefunction, HK, SK, dSK, gap)</cite>。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="（在 Python v3.13）">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cal_band_energy_debug">
<span class="sig-name descname"><span class="pre">cal_band_energy_debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Hon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Son</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Soff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_reciprocal_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.cal_band_energy_debug"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cal_band_energy_debug" title="Link to this definition"></a></dt>
<dd><p>计算能带结构（调试版本）。</p>
<p>通过傅里叶变换将实空间的哈密顿量 H(R) 和重叠矩阵 S(R) 转换为
倒易空间的 H(k) 和 S(k)，然后求解广义本征值问题 <cite>H(k)c = ES(k)c</cite> 来得到能带。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Hon</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 预测的 onsite 哈密顿量。</p></li>
<li><p><strong>Hoff</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 预测的 offsite 哈密顿量。</p></li>
<li><p><strong>Son</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 预测的 onsite 重叠矩阵。</p></li>
<li><p><strong>Soff</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 预测的 offsite 重叠矩阵。</p></li>
<li><p><strong>data</strong> (<em>Data</em>) – 输入数据。</p></li>
<li><p><strong>export_reciprocal_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.13）"><em>bool</em></a>) – 是否返回倒易空间矩阵。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>包含能带能量、波函数、带隙等信息的元组。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="（在 Python v3.13）">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cal_band_energy_soc">
<span class="sig-name descname"><span class="pre">cal_band_energy_soc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Hsoc_on_real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hsoc_on_imag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hsoc_off_real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hsoc_off_imag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.cal_band_energy_soc"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cal_band_energy_soc" title="Link to this definition"></a></dt>
<dd><p>计算包含自旋轨道耦合（SOC）的能带结构。</p>
<p>此方法通过给定的 onsite 和 offsite SOC 哈密顿量的实部和虚部，构建一个 2x2
的块矩阵来表示完整的 SOC 哈密顿量。其中，对角线块是自旋守恒的部分，
非对角线块是自旋翻转的部分。然后通过求解该复厄米矩阵的本征值问题得到能带。</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>当前实现主要针对 <cite>openmx</cite> 类型的哈密顿量。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Hsoc_on_real</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Onsite SOC 哈密顿量的实部。</p></li>
<li><p><strong>Hsoc_on_imag</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Onsite SOC 哈密顿量的虚部。</p></li>
<li><p><strong>Hsoc_off_real</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Offsite SOC 哈密顿量的实部。</p></li>
<li><p><strong>Hsoc_off_imag</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Offsite SOC 哈密顿量的虚部。</p></li>
<li><p><strong>data</strong> (<em>Data</em>) – 输入数据，包含原子结构、k点、重叠矩阵等信息。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>返回一个包含能带能量 <cite>band_energy</cite> 和扁平化的波函数 <cite>wavefunction</cite> 的元组。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="（在 Python v3.13）">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cat_onsite_and_offsite">
<span class="sig-name descname"><span class="pre">cat_onsite_and_offsite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.cat_onsite_and_offsite"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.cat_onsite_and_offsite" title="Link to this definition"></a></dt>
<dd><p>将批处理中的 onsite 和 offsite 矩阵块按顺序拼接起来。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – 输入的图数据。</p></li>
<li><p><strong>Hon</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Onsite 矩阵块。</p></li>
<li><p><strong>Hoff</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Offsite 矩阵块。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>拼接后的矩阵块。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.change_index">
<span class="sig-name descname"><span class="pre">change_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.change_index"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.change_index" title="Link to this definition"></a></dt>
<dd><p>根据 DFT 软件（如 openmx, siesta）的约定，调整输出矩阵元素的顺序。
这确保了生成的哈密顿量与目标软件的原子轨道顺序相匹配。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hamiltonian</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 原始哈密顿量矩阵。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>索引调整后的哈密顿量。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.construct_Hsoc">
<span class="sig-name descname"><span class="pre">construct_Hsoc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iH</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.construct_Hsoc"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.construct_Hsoc" title="Link to this definition"></a></dt>
<dd><p>从自旋对角（实部）和自旋非对角（虚部）块构建复数 SOC 哈密顿量。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – SOC 哈密顿量的实部块。</p></li>
<li><p><strong>iH</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – SOC 哈密顿量的虚部块。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>完整的复数 SOC 哈密顿量张量。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.convert_to_mole_Ham">
<span class="sig-name descname"><span class="pre">convert_to_mole_Ham</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.convert_to_mole_Ham"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.convert_to_mole_Ham" title="Link to this definition"></a></dt>
<dd><p>将 onsite 和 offsite 矩阵块组装成完整的分子哈密顿量。
这个函数目前似乎没有被使用。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – 输入的图数据。</p></li>
<li><p><strong>Hon</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Onsite 哈密顿量块。</p></li>
<li><p><strong>Hoff</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Offsite 哈密顿量块。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>组装后的完整哈密顿量。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_representation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.forward" title="Link to this definition"></a></dt>
<dd><p>模型的核心前向传播逻辑。</p>
<p>该方法根据 <cite>__init__</cite> 中设置的各种开关（如 <cite>soc_switch</cite>, <cite>spin_constrained</cite> 等），
执行不同的计算路径来构建哈密顿量和重叠矩阵，并最终计算能带结构等物理属性。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Data</em>) – PyG 图数据对象，可能包含预计算的矩阵。</p></li>
<li><p><strong>graph_representation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.13）"><em>dict</em></a><em>, </em><em>optional</em>) – 来自 GNN 表示层的节点和边等变特征字典。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>一个包含计算结果的字典，可能包括 ‘hamiltonian’, ‘overlap’,</dt><dd><p>’band_energy’, ‘wavefunction’ 等键。</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.13）">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.get_basis_definition">
<span class="sig-name descname"><span class="pre">get_basis_definition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.get_basis_definition"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.get_basis_definition" title="Link to this definition"></a></dt>
<dd><p>为掩码计算创建并返回基组定义张量。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 原子序数张量。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>一个 <cite>(99, nao_max)</cite> 的张量，其中 <cite>basis_definition[z, i] = 1</cite></dt><dd><p>表示原子 <cite>z</cite> 包含轨道 <cite>i</cite>。</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.get_unique_cell_shift_and_cell_shift_indices">
<span class="sig-name descname"><span class="pre">get_unique_cell_shift_and_cell_shift_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.get_unique_cell_shift_and_cell_shift_indices"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.get_unique_cell_shift_and_cell_shift_indices" title="Link to this definition"></a></dt>
<dd><p>从边的晶胞位移中找到唯一的位移向量，并为每条边提供其对应的唯一位移索引。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data</em>) – PyG 图数据对象。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>返回 <cite>(unique_cell_shift, cell_shift_indices, cell_index_map)</cite>。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="（在 Python v3.13）">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.index_cells">
<span class="sig-name descname"><span class="pre">index_cells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unique_cell_shift_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.index_cells"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.index_cells" title="Link to this definition"></a></dt>
<dd><p>将每个唯一的晶胞位移向量映射到其在唯一列表中的索引。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>unique_cell_shift_list</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）"><em>int</em></a><em>, </em><em>...</em><em>]</em><em>]</em>) – 唯一晶胞位移向量的列表。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>一个字典，键是晶胞位移元组，值是其索引。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="（在 Python v3.13）">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.mask_Ham">
<span class="sig-name descname"><span class="pre">mask_Ham</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Hon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.mask_Ham"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.mask_Ham" title="Link to this definition"></a></dt>
<dd><p>根据每种原子的实际轨道数，对哈密顿量和重叠矩阵进行掩码操作。</p>
<p>此函数确保只有在物理上存在的原子轨道之间的矩阵元才具有非零值，
而那些由于使用固定大小 <cite>nao_max</cite> 导致的填充项则被置零。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Hon</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Onsite 矩阵块 (哈密顿量或重叠矩阵)。</p></li>
<li><p><strong>Hoff</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Offsite 矩阵块 (哈密顿量或重叠矩阵)。</p></li>
<li><p><strong>data</strong> (<em>Data</em>) – 输入数据，需要 <cite>z</cite> 和 <cite>edge_index</cite>。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>返回一个元组，包含掩码后的 <cite>(Hon, Hoff)</cite>。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="（在 Python v3.13）">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.mask_tensor_builder">
<span class="sig-name descname"><span class="pre">mask_tensor_builder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.mask_tensor_builder"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.mask_tensor_builder" title="Link to this definition"></a></dt>
<dd><p>构建掩码张量并返回拼接后的掩码张量。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data</em>) – PyG 图数据对象。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>拼接后的 on-site 和 off-site 掩码。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.mask_tensor_builder_col">
<span class="sig-name descname"><span class="pre">mask_tensor_builder_col</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.mask_tensor_builder_col"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.mask_tensor_builder_col" title="Link to this definition"></a></dt>
<dd><p>为共线自旋情况构建掩码张量。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data</em>) – PyG 图数据对象。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>适用于共线自旋计算的拼接掩码。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.mask_tensor_builder_soc">
<span class="sig-name descname"><span class="pre">mask_tensor_builder_soc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.mask_tensor_builder_soc"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.mask_tensor_builder_soc" title="Link to this definition"></a></dt>
<dd><p>为包含自旋轨道耦合的情况构建掩码张量。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data</em>) – PyG 图数据对象。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>返回一个元组 <cite>(mask_real_imag, mask_all)</cite>，</dt><dd><p>分别对应 SOC 哈密顿量的实部/虚部掩码和总掩码。</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="（在 Python v3.13）">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.matrix_0rank_merge">
<span class="sig-name descname"><span class="pre">matrix_0rank_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sph_split</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.matrix_0rank_merge"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.matrix_0rank_merge" title="Link to this definition"></a></dt>
<dd><p>将零阶（标量）球谐系数合并为矩阵。</p>
<p>这用于非 SOC 情况下的交换项 J，其中 J 是一个标量。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sph_split</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="（在 Python v3.13）"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 对应零阶 Irreps 的系数列表。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>形状为 <cite>(N_batch, nao_max, nao_max)</cite> 的矩阵。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.matrix_2rank_merge">
<span class="sig-name descname"><span class="pre">matrix_2rank_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sph_split</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.matrix_2rank_merge"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.matrix_2rank_merge" title="Link to this definition"></a></dt>
<dd><p>将球谐系数合并为二阶张量（3x3矩阵），用于 SOC 计算中的交换项 J。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sph_split</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="（在 Python v3.13）"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 对应 <cite>self.J_irreps</cite> 的球谐系数列表。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>形状为 <cite>(N_batch, N_blocks, 3, 3)</cite> 的张量。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.matrix_merge">
<span class="sig-name descname"><span class="pre">matrix_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sph_split</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.matrix_merge"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.matrix_merge" title="Link to this definition"></a></dt>
<dd><p>将一系列球谐系数（等变特征）通过 Clebsch-Gordan 积合并成矩阵块。</p>
<p>这是模型的核心步骤之一，它将神经网络预测的抽象特征（<cite>sph_split</cite>）
转换为物理上可解释的哈密顿量或重叠矩阵的组成部分。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sph_split</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="（在 Python v3.13）"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 一个张量列表，每个张量对应 <cite>self.ham_irreps</cite> 中的一个不可约表示的系数。
形状为 <cite>(N_batch, 2L+1)</cite>。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>合并后的矩阵块，形状为 <cite>(N_batch, nao_max * nao_max)</cite>。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.reduce">
<span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coefficient</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.reduce"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.reduce" title="Link to this definition"></a></dt>
<dd><p>通过 Clebsch-Gordan 分解，将矩阵块分解为球谐系数（等变特征）。</p>
<p>这是 <cite>matrix_merge</cite> 的逆过程。它通过在轨道组内取平均值来近似地提取
具有特定角动量 <cite>l</cite> 的特征分量。这主要用于调试或分析目的，以检查
网络是否学习到了符合物理对称性的特征。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coefficient</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 形状为 <cite>(N, nao_max, nao_max)</cite> 的矩阵块。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>分解得到的球谐系数，形状被重新扁平化为 <cite>(N, nao_max*nao_max)</cite>。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.symmetrize_Hoff">
<span class="sig-name descname"><span class="pre">symmetrize_Hoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Hoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_edge_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'+'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.symmetrize_Hoff"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.symmetrize_Hoff" title="Link to this definition"></a></dt>
<dd><p>对称化 Offsite 矩阵块。
利用 <cite>inv_edge_idx</cite> (逆向边的索引) 来确保 H_ij = H_ji.T。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Hoff</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Offsite 矩阵块。</p></li>
<li><p><strong>inv_edge_idx</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 逆向边的索引。</p></li>
<li><p><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.13）"><em>str</em></a>) – 对称化方式，’+’ 或 ‘-’。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>对称化后的矩阵。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.symmetrize_Hoff_soc">
<span class="sig-name descname"><span class="pre">symmetrize_Hoff_soc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Hoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_edge_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'+'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.symmetrize_Hoff_soc"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.symmetrize_Hoff_soc" title="Link to this definition"></a></dt>
<dd><p>对称化包含 SOC 的 Offsite 矩阵块 (尺寸为 2*nao_max)。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.symmetrize_Hon">
<span class="sig-name descname"><span class="pre">symmetrize_Hon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Hon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'+'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.symmetrize_Hon"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.symmetrize_Hon" title="Link to this definition"></a></dt>
<dd><p>对称化 Onsite 矩阵块。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Hon</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Onsite 矩阵块。</p></li>
<li><p><strong>sign</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.13）"><em>str</em></a>) – 对称化方式，’+’ 表示 (A + A.T)/2 (厄米)，’-’ 表示 (A - A.T)/2 (反厄米)。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>对称化后的矩阵。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.symmetrize_Hon_soc">
<span class="sig-name descname"><span class="pre">symmetrize_Hon_soc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Hon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'+'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNPlusPlusOut.symmetrize_Hon_soc"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNPlusPlusOut.symmetrize_Hon_soc" title="Link to this definition"></a></dt>
<dd><p>对称化包含 SOC 的 Onsite 矩阵块 (尺寸为 2*nao_max)。</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.net.</span></span><span class="sig-name descname"><span class="pre">HamGNNTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNTransformer"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer" title="Link to this definition"></a></dt>
<dd><p>基于 E(3) 等变 Transformer 的 HamGNN 模型。</p>
<p>该模型采用等变自注意力机制来捕捉原子间的相互作用，替代了传统的卷积操作。
它允许模型在更新节点特征时，动态地权衡来自不同邻居的信息。
模型的整体结构与 <cite>HamGNNConvE3</cite> 相似，但核心交互层换成了 <cite>AttentionBlockE3</cite>。</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.num_types">
<span class="sig-name descname"><span class="pre">num_types</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.num_types" title="Link to this definition"></a></dt>
<dd><p>系统中原子种类的数量。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.cutoff" title="Link to this definition"></a></dt>
<dd><p>径向截断半径。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="（在 Python v3.13）">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.num_layers">
<span class="sig-name descname"><span class="pre">num_layers</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.num_layers" title="Link to this definition"></a></dt>
<dd><p>等变 Transformer 层的数量。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.irreps_node_features">
<span class="sig-name descname"><span class="pre">irreps_node_features</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.irreps_node_features" title="Link to this definition"></a></dt>
<dd><p>节点特征的不可约表示。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>o3.Irreps</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.num_heads">
<span class="sig-name descname"><span class="pre">num_heads</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.num_heads" title="Link to this definition"></a></dt>
<dd><p>自注意力机制中的头数。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.radial_basis_functions">
<span class="sig-name descname"><span class="pre">radial_basis_functions</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.radial_basis_functions" title="Link to this definition"></a></dt>
<dd><p>径向基函数模块。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.atomic_embedding">
<span class="sig-name descname"><span class="pre">atomic_embedding</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.atomic_embedding" title="Link to this definition"></a></dt>
<dd><p>将原子种类转换为独热编码的模块。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.spharm_edges">
<span class="sig-name descname"><span class="pre">spharm_edges</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.spharm_edges" title="Link to this definition"></a></dt>
<dd><p>计算边向量的球谐函数的模块。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.radial_basis">
<span class="sig-name descname"><span class="pre">radial_basis</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.radial_basis" title="Link to this definition"></a></dt>
<dd><p>编码边长度的径向基函数模块。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.pair_embedding">
<span class="sig-name descname"><span class="pre">pair_embedding</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.pair_embedding" title="Link to this definition"></a></dt>
<dd><p>嵌入原子对相互作用的初始特征。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.chemical_embedding">
<span class="sig-name descname"><span class="pre">chemical_embedding</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.chemical_embedding" title="Link to this definition"></a></dt>
<dd><p>将独热编码嵌入到初始节点特征中。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.orb_transformers">
<span class="sig-name descname"><span class="pre">orb_transformers</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.orb_transformers" title="Link to this definition"></a></dt>
<dd><p>等变 Transformer 层列表。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ModuleList</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.corr_products">
<span class="sig-name descname"><span class="pre">corr_products</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.corr_products" title="Link to this definition"></a></dt>
<dd><p>相关性乘积层列表。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ModuleList</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.pair_interactions">
<span class="sig-name descname"><span class="pre">pair_interactions</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.pair_interactions" title="Link to this definition"></a></dt>
<dd><p>原子对相互作用层列表。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.ModuleList</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/net.html#HamGNNTransformer.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.net.HamGNNTransformer.forward" title="Link to this definition"></a></dt>
<dd><p>执行模型的前向传播。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data</em><em> or </em><em>EasyDict</em>) – 输入的图数据对象，遵循 PyG 或 Nequip 的数据格式。
需要包含 <cite>pos</cite>, <cite>z</cite>, <cite>edge_index</cite> 等原子结构信息。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>一个包含最终节点和边等变特征的字典。
- ‘node_attr’: 节点的等变特征张量。
- ‘edge_attr’: 边的等变特征张量。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>EasyDict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-HamGNN_v_2_0.models.HamGNN.BaseModel">
<span id="basemodel-py"></span><h2>基础模型 (<cite>BaseModel.py</cite>)<a class="headerlink" href="#module-HamGNN_v_2_0.models.HamGNN.BaseModel" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.BaseModel.</span></span><span class="sig-name descname"><span class="pre">BaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'openmx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/BaseModel.html#BaseModel"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel" title="Link to this definition"></a></dt>
<dd><p>所有 HamGNN 图学习模型的基类。</p>
<p>它封装了动态图构建的核心逻辑。</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.radius_type">
<span class="sig-name descname"><span class="pre">radius_type</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.radius_type" title="Link to this definition"></a></dt>
<dd><p>用于确定原子半径的来源类型 (e.g., ‘openmx’)。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.13）">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.radius_scale">
<span class="sig-name descname"><span class="pre">radius_scale</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.radius_scale" title="Link to this definition"></a></dt>
<dd><p>原子半径的缩放因子。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="（在 Python v3.13）">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/BaseModel.html#BaseModel.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.forward" title="Link to this definition"></a></dt>
<dd><p>前向传播的占位符，应在子类中实现。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.generate_graph">
<span class="sig-name descname"><span class="pre">generate_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/BaseModel.html#BaseModel.generate_graph"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.generate_graph" title="Link to this definition"></a></dt>
<dd><p>根据原子位置和种类动态生成计算图（邻居列表）。</p>
<p>此方法会忽略 <cite>data</cite> 中预先计算的 <cite>edge_index</cite>，并根据每种原子的
化学性质（半径）和 <cite>radius_scale</cite> 重新计算邻居关系。
它还会找到新生成的图的边与原始图的边的对应关系。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Data</em>) – 输入的图数据对象，必须包含 <cite>pos</cite>, <cite>z</cite>, <cite>cell</cite>, <cite>batch</cite> 等信息。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>一个包含新生成的图信息的字典。
- ‘z’: 原子序数。
- ‘pos’: 原子位置。
- ‘edge_index’: 新的边索引。
- ‘cell_shift’: 边的晶胞平移向量。
- ‘nbr_shift’: 邻居的相对位置向量。
- ‘batch’: 批处理索引。
- ‘matching_edges’: 新图的边在原始图中的匹配索引。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>EasyDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.num_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）"><span class="pre">int</span></a></em><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.BaseModel.num_params" title="Link to this definition"></a></dt>
<dd><p>计算模型的总参数数量。</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.BaseModel.find_matching_columns_of_A_in_B">
<span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.BaseModel.</span></span><span class="sig-name descname"><span class="pre">find_matching_columns_of_A_in_B</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/BaseModel.html#find_matching_columns_of_A_in_B"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.find_matching_columns_of_A_in_B" title="Link to this definition"></a></dt>
<dd><p>在矩阵 B 中查找与矩阵 A 匹配的列。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 第一个矩阵。</p></li>
<li><p><strong>B</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 第二个矩阵。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>在 B 中匹配列的索引。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.BaseModel.get_radii_from_atomic_numbers">
<span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.BaseModel.</span></span><span class="sig-name descname"><span class="pre">get_radii_from_atomic_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atomic_numbers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'openmx'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/BaseModel.html#get_radii_from_atomic_numbers"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.get_radii_from_atomic_numbers" title="Link to this definition"></a></dt>
<dd><p>根据原子序数列表检索缩放后的原子半径。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atomic_numbers</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a><em>, </em><em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）"><em>int</em></a><em>]</em><em>]</em>) – 包含原子序数的列表或张量。</p></li>
<li><p><strong>radius_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="（在 Python v3.13）"><em>float</em></a>) – 原子半径的缩放因子，默认为 1.5。</p></li>
<li><p><strong>radius_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.13）"><em>str</em></a>) – 所用原子半径的来源软件，默认为 ‘openmx’。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>与输入原子序数对应的缩放后的原子半径列表。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="（在 Python v3.13）">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.BaseModel.neighbor_list_and_relative_vec">
<span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.BaseModel.</span></span><span class="sig-name descname"><span class="pre">neighbor_list_and_relative_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_interaction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict_self_interaction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/BaseModel.html#neighbor_list_and_relative_vec"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.BaseModel.neighbor_list_and_relative_vec" title="Link to this definition"></a></dt>
<dd><p>基于径向截断距离创建邻居列表和相对向量。</p>
<p>边的约定如下:
- <cite>edge_index[0]</cite> 是 <em>源</em> (卷积中心)。
- <cite>edge_index[1]</cite> 是 <em>目标</em> (邻居)。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>shape</em><em> [</em><em>N</em><em>, </em><em>3</em><em>]</em>) – 原子位置坐标；可以是 Tensor 或 numpy 数组。</p></li>
<li><p><strong>r_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="（在 Python v3.13）"><em>float</em></a>) – 用于寻找邻居的径向截断距离。</p></li>
<li><p><strong>cell</strong> (<em>numpy shape</em><em> [</em><em>3</em><em>, </em><em>3</em><em>]</em>) – 周期性边界条件的晶胞矩阵。</p></li>
<li><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.13）"><em>bool</em></a><em> or </em><em>3-tuple</em><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.13）"><em>bool</em></a>) – 三个维度上的周期性。</p></li>
<li><p><strong>self_interaction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.13）"><em>bool</em></a>) – 是否包括相同周期性镜像的自相互作用边。</p></li>
<li><p><strong>strict_self_interaction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.13）"><em>bool</em></a>) – 是否包括任何自相互作用边。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>边的列表。
shifts (torch.Tensor [num_edges, 3]): 相对晶胞平移向量。
cell_tensor (torch.Tensor [3, 3]): 晶胞张量。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>edge_index (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a> [2, num_edges])</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-HamGNN_v_2_0.models.HamGNN.Attention_kan">
<span id="kan-attention-kan-py"></span><h2>注意力与 KAN 层 (<cite>Attention_kan.py</cite>)<a class="headerlink" href="#module-HamGNN_v_2_0.models.HamGNN.Attention_kan" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionAggregation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">AttentionAggregation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_query</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#AttentionAggregation"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionAggregation" title="Link to this definition"></a></dt>
<dd><p>An equivariant attention mechanism that processes key, value, and query vectors
and applies attention across edges in a graph.</p>
<p>Parameters:
- num_heads (int): Number of attention heads.
- irreps_key (o3.Irreps): Irreducible representations for key vectors.
- irreps_value (o3.Irreps): Irreducible representations for value vectors.
- irreps_query (o3.Irreps): Irreducible representations for query vectors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionAggregation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#AttentionAggregation.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionAggregation.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the attention mechanism.</p>
<p>Parameters:
- key (torch.Tensor): Key vectors.
- value (torch.Tensor): Value vectors.
- query (torch.Tensor): Query vectors.
- edge_weight_cutoff (torch.Tensor): Cutoff weights for edges.
- edge_index (torch.LongTensor): Edge indices.</p>
<p>Returns:
- torch.Tensor: Attended output vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionAggregationV2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">AttentionAggregationV2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#AttentionAggregationV2"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionAggregationV2" title="Link to this definition"></a></dt>
<dd><p>An equivariant attention mechanism that processes key, value, and query vectors
and applies attention across edges in a graph.</p>
<p>Parameters:
- num_heads (int): Number of attention heads.
- irreps_value (o3.Irreps): Irreducible representations for value vectors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionAggregationV2.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weights_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#AttentionAggregationV2.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionAggregationV2.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the attention mechanism.</p>
<p>Parameters:
- key (torch.Tensor): Key vectors.
- value (torch.Tensor): Value vectors.
- query (torch.Tensor): Query vectors.
- edge_weight_cutoff (torch.Tensor): Cutoff weights for edges.
- edge_index (torch.LongTensor): Edge indices.</p>
<p>Returns:
- torch.Tensor: Attended output vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">AttentionBlockE3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_node_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_embed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_MLP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_skip_connections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_kan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_scalars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'e':</span> <span class="pre">'ssp',</span> <span class="pre">'o':</span> <span class="pre">'tanh'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_gates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'e':</span> <span class="pre">'ssp',</span> <span class="pre">'o':</span> <span class="pre">'abs'}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#AttentionBlockE3"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3" title="Link to this definition"></a></dt>
<dd><p>An equivariant attention block for processing graph data with attention mechanisms.</p>
<p>Parameters:
- irreps_in (o3.Irreps): Input irreducible representations.
- irreps_out (o3.Irreps): Output irreducible representations.
- irreps_node_attrs (o3.Irreps): Node attribute irreducible representations.
- irreps_edge_attrs (o3.Irreps): Edge attribute irreducible representations.
- irreps_edge_embed (o3.Irreps): Edge embedding irreducible representations.
- num_heads (int): Number of attention heads.
- max_radius (float): Maximum radius for edge cutoff.
- radial_MLP (Optional[List[int]]): Architecture of the radial MLP.
- use_skip_connections (bool): Whether to use skip connections.
- use_kan (bool): Whether to use KAN for radial MLP.
- nonlinearity_type (str): Type of nonlinearity (‘gate’ or ‘norm’).
- nonlinearity_scalars (Dict[int, Callable]): Scalar nonlinearity functions.
- nonlinearity_gates (Dict[int, Callable]): Gate nonlinearity functions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.create_linear">
<span class="sig-name descname"><span class="pre">create_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#AttentionBlockE3.create_linear"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.create_linear" title="Link to this definition"></a></dt>
<dd><p>Create a linear layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.create_nonlinearity">
<span class="sig-name descname"><span class="pre">create_nonlinearity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_scalars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_gates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#AttentionBlockE3.create_nonlinearity"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.create_nonlinearity" title="Link to this definition"></a></dt>
<dd><p>Create nonlinearity module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.create_tensor_product">
<span class="sig-name descname"><span class="pre">create_tensor_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_mid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instructions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#AttentionBlockE3.create_tensor_product"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.create_tensor_product" title="Link to this definition"></a></dt>
<dd><p>Create a TensorProduct layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#AttentionBlockE3.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the attention block.</p>
<p>Parameters:
- data (Dict[str, torch.Tensor]): A dictionary containing the graph data.</p>
<p>Returns:
- Tuple[torch.Tensor, Optional[torch.Tensor]]: Updated node features and skip connection.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="（在 Python v3.13）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="（在 Python v3.13）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.init_weight_generator">
<span class="sig-name descname"><span class="pre">init_weight_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_numel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#AttentionBlockE3.init_weight_generator"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionBlockE3.init_weight_generator" title="Link to this definition"></a></dt>
<dd><p>Initialize weight generator.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionHeadsToVector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">AttentionHeadsToVector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_head</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#AttentionHeadsToVector"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionHeadsToVector" title="Link to this definition"></a></dt>
<dd><p>Converts vectors of shape [N, num_heads, irreps_head] into vectors of shape [N, irreps_head * num_heads].</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionHeadsToVector.irreps_head">
<span class="sig-name descname"><span class="pre">irreps_head</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionHeadsToVector.irreps_head" title="Link to this definition"></a></dt>
<dd><p>A list of irreducible representations (irreps) that define
the structure of the attention heads.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>o3.Irreps</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionHeadsToVector.head_sizes">
<span class="sig-name descname"><span class="pre">head_sizes</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionHeadsToVector.head_sizes" title="Link to this definition"></a></dt>
<dd><p>A list of sizes for each attention head, derived from the irreps.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionHeadsToVector.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#AttentionHeadsToVector.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.AttentionHeadsToVector.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass to process the attention heads and flatten them into a single vector.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Input tensor of shape (N, num_heads, input_dim), where:
- N is the batch size.
- num_heads is the number of attention heads.
- input_dim is the total size of all heads.</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Output tensor of shape (N, flattened_dim), where <cite>flattened_dim</cite></dt><dd><p>is the sum of the dimensions of all attention heads.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="（在 Python v3.13）"><strong>ValueError</strong></a> – If the sum of <cite>head_sizes</cite> does not match <cite>input_dim</cite> of the input tensor.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.ClebschGordanCoefficients">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">ClebschGordanCoefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#ClebschGordanCoefficients"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ClebschGordanCoefficients" title="Link to this definition"></a></dt>
<dd><p>A PyTorch module for pre-computing and storing Clebsch-Gordan coefficients,
which can then be accessed during the forward pass.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.ClebschGordanCoefficients.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#ClebschGordanCoefficients.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ClebschGordanCoefficients.forward" title="Link to this definition"></a></dt>
<dd><p>Retrieve the pre-computed Clebsch-Gordan coefficient for the given angular momenta.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l1</strong> – First angular momentum value.</p></li>
<li><p><strong>l2</strong> – Second angular momentum value.</p></li>
<li><p><strong>l3</strong> – Third angular momentum value.</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>The Clebsch-Gordan coefficient tensor.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.ConcatenatedIrrepsTensorProduct">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">ConcatenatedIrrepsTensorProduct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_in2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_tensors_in1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_scalars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_MLP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_kan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#ConcatenatedIrrepsTensorProduct"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ConcatenatedIrrepsTensorProduct" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.ConcatenatedIrrepsTensorProduct.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensors1_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#ConcatenatedIrrepsTensorProduct.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ConcatenatedIrrepsTensorProduct.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass for the ConcatenatedIrrepsTensorProduct module.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_tensors1_list</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a><em>]</em>) – List of tensors for the first input.</p></li>
<li><p><strong>input_tensor2</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Tensor for the second input.</p></li>
<li><p><strong>scalars</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Scalar inputs for weight generation.</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>Processed output tensor.</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.ConvBlockE3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">ConvBlockE3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_node_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_embed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_MLP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_skip_connections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_kan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_scalars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'e':</span> <span class="pre">'ssp',</span> <span class="pre">'o':</span> <span class="pre">'tanh'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_gates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'e':</span> <span class="pre">'ssp',</span> <span class="pre">'o':</span> <span class="pre">'abs'}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#ConvBlockE3"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ConvBlockE3" title="Link to this definition"></a></dt>
<dd><p>An equivariant convolutional block for processing node features using tensor products
with optional skip connections.</p>
<p>Parameters:
- irreps_in (o3.Irreps): Input irreducible representations.
- irreps_out (o3.Irreps): Output irreducible representations.
- irreps_edge_attrs (o3.Irreps): Edge attribute irreducible representations.
- irreps_edge_embed (o3.Irreps): Edge embedding irreducible representations.
- radial_MLP (Optional[List[int]]): MLP architecture for radial embeddings. Defaults to [64, 64, 64].
- use_skip_connections (bool): Whether to use skip connections. Defaults to True.
- use_kan (bool): Whether to use the FastKAN module for weight generation. Defaults to False.
- nonlinearity_type (str): Type of nonlinearity to use (“gate” or “norm”). Defaults to “gate”.
- nonlinearity_scalars (Dict[int, Callable]): Nonlinearity for scalar channels.
- nonlinearity_gates (Dict[int, Callable]): Nonlinearity for gate channels.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.ConvBlockE3.create_linear">
<span class="sig-name descname"><span class="pre">create_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#ConvBlockE3.create_linear"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ConvBlockE3.create_linear" title="Link to this definition"></a></dt>
<dd><p>Create a linear layer.</p>
<p>Parameters:
- irreps_in (o3.Irreps): Input irreps for the linear layer.
- irreps_out (o3.Irreps, optional): Output irreps for the linear layer.</p>
<p>Returns:
- o3.Linear: A linear transformation layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.ConvBlockE3.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#ConvBlockE3.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ConvBlockE3.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the convolutional block.</p>
<p>Parameters:
- data (dict): Dictionary containing graph data.</p>
<p>Returns:
- torch.Tensor: Updated node features.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.CorrProductBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">CorrProductBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_node_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hidden_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correlation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_skip_connections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#CorrProductBlock"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.CorrProductBlock" title="Link to this definition"></a></dt>
<dd><p>A correlation product block for updating node features using an equivariant product operation.</p>
<p>Parameters:
- irreps_node_feats (o3.Irreps): Irreducible representations for node features.
- num_hidden_features (int): Number of hidden features.
- correlation (int): Correlation level for the product operation.
- use_skip_connections (bool): Whether to use skip connections.
- num_elements (int): Number of elements for the product operation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.CorrProductBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#CorrProductBlock.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.CorrProductBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the correlation product block.</p>
<p>Parameters:
- data (Dict[str, torch.Tensor]): A dictionary containing the graph data.</p>
<p>Returns:
- torch.Tensor: Updated node features.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.EdgeScalarEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">EdgeScalarEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_node_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_embed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_scalars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#EdgeScalarEmbedding"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.EdgeScalarEmbedding" title="Link to this definition"></a></dt>
<dd><p>A layer to compute edge scalars from node attributes and edge embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>irreps_node_attrs</strong> (<em>Irreps</em>) – Irreps for node attributes.</p></li>
<li><p><strong>irreps_edge_embed</strong> (<em>Irreps</em>) – Irreps for edge embeddings.</p></li>
<li><p><strong>irreps_edge_scalars</strong> (<em>Irreps</em>) – Irreps for edge scalars.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.EdgeScalarEmbedding.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_attr_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_attr_dst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_embed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#EdgeScalarEmbedding.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.EdgeScalarEmbedding.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass to compute edge scalars.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node_attr_src</strong> (<em>Tensor</em>) – Source node attributes.</p></li>
<li><p><strong>node_attr_dst</strong> (<em>Tensor</em>) – Destination node attributes.</p></li>
<li><p><strong>edge_embed</strong> (<em>Tensor</em>) – Edge embeddings.</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>Computed edge scalars.</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.HamLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">HamLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_irreps_hidden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resnet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#HamLayer"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.HamLayer" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.HamLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#HamLayer.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.HamLayer.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.LinearScaleWithWeights">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">LinearScaleWithWeights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#LinearScaleWithWeights"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.LinearScaleWithWeights" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.LinearScaleWithWeights.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#LinearScaleWithWeights.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.LinearScaleWithWeights.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.LocalEnvironmentEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">LocalEnvironmentEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_edge_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_embed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_node_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_scalars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_env_sh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_MLP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[64,</span> <span class="pre">64]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_kan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#LocalEnvironmentEmbedding"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.LocalEnvironmentEmbedding" title="Link to this definition"></a></dt>
<dd><p>Embeds local environments using node and edge attributes, edge embeddings, and spherical harmonics.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>irreps_edge_attrs</strong> (<em>Irreps</em>) – Irreps for edge attributes.</p></li>
<li><p><strong>irreps_edge_embed</strong> (<em>Irreps</em>) – Irreps for edge embeddings.</p></li>
<li><p><strong>irreps_node_attrs</strong> (<em>Irreps</em>) – Irreps for node attributes.</p></li>
<li><p><strong>irreps_edge_scalars</strong> (<em>Irreps</em>) – Irreps for edge scalars.</p></li>
<li><p><strong>irreps_env_sh</strong> (<em>Irreps</em>) – Irreps for environment spherical harmonics.</p></li>
<li><p><strong>radial_mlp_dims</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="（在 Python v3.13）"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）"><em>int</em></a><em>]</em>) – Dimensions for the radial MLP.</p></li>
<li><p><strong>use_kan</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.13）"><em>bool</em></a>) – Whether to use the KAN model.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.LocalEnvironmentEmbedding.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_embed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#LocalEnvironmentEmbedding.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.LocalEnvironmentEmbedding.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass to compute local environment embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_index</strong> (<em>Tensor</em>) – Indices of the edges.</p></li>
<li><p><strong>node_attr</strong> (<em>Tensor</em>) – Node attributes.</p></li>
<li><p><strong>edge_attr</strong> (<em>Tensor</em>) – Edge attributes.</p></li>
<li><p><strong>edge_embed</strong> (<em>Tensor</em>) – Edge embeddings.</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>Local environment embeddings.</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.MessagePackBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">MessagePackBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_node_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_local_env_edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_scalars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_MLP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[64,</span> <span class="pre">64]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_kan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#MessagePackBlock"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.MessagePackBlock" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.MessagePackBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_feats_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feats_dst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_env_edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_scalars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#MessagePackBlock.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.MessagePackBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.MessagePackBlockV2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">MessagePackBlockV2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_node_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_local_env_edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_scalars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_MLP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[64,</span> <span class="pre">64]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_kan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#MessagePackBlockV2"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.MessagePackBlockV2" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.MessagePackBlockV2.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_feats_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feats_dst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_env_edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_scalars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#MessagePackBlockV2.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.MessagePackBlockV2.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.OverlapExpand">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">OverlapExpand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ham_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao_max</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#OverlapExpand"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.OverlapExpand" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.OverlapExpand.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#OverlapExpand.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.OverlapExpand.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass to expand overlap data.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Object containing ‘Son’ and ‘Soff’ tensors to be expanded.</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated data object with expanded ‘Son’ and ‘Soff’.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">PairInteractionBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_node_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_node_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_embed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_skip_connections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_kan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_MLP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_scalars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'e':</span> <span class="pre">'ssp',</span> <span class="pre">'o':</span> <span class="pre">'tanh'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_gates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'e':</span> <span class="pre">'ssp',</span> <span class="pre">'o':</span> <span class="pre">'abs'}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#PairInteractionBlock"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionBlock" title="Link to this definition"></a></dt>
<dd><p>A pair interaction block for updating edge features based on node features and edge attributes.</p>
<p>Parameters:
- irreps_node_feats (o3.Irreps): Irreducible representations for node features.
- irreps_edge_attrs (o3.Irreps): Irreducible representations for edge attributes.
- irreps_edge_embed (o3.Irreps): Irreducible representations for edge embeddings.
- irreps_edge_feats (o3.Irreps): Irreducible representations for edge features.
- use_skip_connections (bool): Whether to use skip connections.
- use_kan (bool): Whether to use KAN for radial MLP.
- radial_MLP (Optional[List[int]]): Architecture of the radial MLP. Defaults to [64, 64, 64].
- nonlinearity_type (str): Type of nonlinearity to use (“gate” or “norm”).
- nonlinearity_scalars (Dict[int, Callable]): Nonlinearity for scalar channels.
- nonlinearity_gates (Dict[int, Callable]): Nonlinearity for gate channels.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionBlock.create_linear">
<span class="sig-name descname"><span class="pre">create_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#PairInteractionBlock.create_linear"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionBlock.create_linear" title="Link to this definition"></a></dt>
<dd><p>Create a linear layer.</p>
<p>Parameters:
- irreps_in (o3.Irreps): Input irreps for the linear layer.
- irreps_out (o3.Irreps, optional): Output irreps for the linear layer.</p>
<p>Returns:
- o3.Linear: A linear transformation layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#PairInteractionBlock.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the pair interaction block.</p>
<p>Parameters:
- data (Dict[str, torch.Tensor]): A dictionary containing the graph data.</p>
<p>Returns:
- torch.Tensor: Updated edge features.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">PairInteractionEmbeddingBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_node_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_node_attrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_embed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_edge_feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_kan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_MLP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_scalars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'e':</span> <span class="pre">'ssp',</span> <span class="pre">'o':</span> <span class="pre">'tanh'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_gates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'e':</span> <span class="pre">'ssp',</span> <span class="pre">'o':</span> <span class="pre">'abs'}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#PairInteractionEmbeddingBlock"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock" title="Link to this definition"></a></dt>
<dd><p>A pair interaction block for updating edge features based on node features and edge attributes.</p>
<p>Parameters:
- irreps_node_feats (o3.Irreps): Irreducible representations for node features.
- irreps_edge_attrs (o3.Irreps): Irreducible representations for edge attributes.
- irreps_edge_embed (o3.Irreps): Irreducible representations for edge embeddings.
- irreps_edge_feats (o3.Irreps): Irreducible representations for edge features.
- use_skip_connections (bool): Whether to use skip connections.
- use_kan (bool): Whether to use KAN for radial MLP.
- radial_MLP (Optional[List[int]]): Architecture of the radial MLP.
- nonlinearity_type (str): Type of nonlinearity to use (“gate” or “norm”).
- nonlinearity_scalars (Dict[int, Callable]): Nonlinearity for scalar channels.
- nonlinearity_gates (Dict[int, Callable]): Nonlinearity for gate channels.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock.create_linear">
<span class="sig-name descname"><span class="pre">create_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#PairInteractionEmbeddingBlock.create_linear"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock.create_linear" title="Link to this definition"></a></dt>
<dd><p>Create a linear layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock.create_tensor_product">
<span class="sig-name descname"><span class="pre">create_tensor_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_mid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instructions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#PairInteractionEmbeddingBlock.create_tensor_product"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock.create_tensor_product" title="Link to this definition"></a></dt>
<dd><p>Create a TensorProduct layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#PairInteractionEmbeddingBlock.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the pair interaction block.</p>
<p>Parameters:
- data (Dict[str, torch.Tensor]): A dictionary containing the graph data.</p>
<p>Returns:
- torch.Tensor: Updated edge features.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock.init_weight_generator">
<span class="sig-name descname"><span class="pre">init_weight_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_numel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#PairInteractionEmbeddingBlock.init_weight_generator"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.PairInteractionEmbeddingBlock.init_weight_generator" title="Link to this definition"></a></dt>
<dd><p>Initialize weight generator.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.RadialBasisEdgeEncoding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">RadialBasisEdgeEncoding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'edge_embedding'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#RadialBasisEdgeEncoding"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.RadialBasisEdgeEncoding" title="Link to this definition"></a></dt>
<dd><p>Encodes edge lengths using a specified radial basis.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.RadialBasisEdgeEncoding.out_field">
<span class="sig-name descname"><span class="pre">out_field</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.RadialBasisEdgeEncoding.out_field" title="Link to this definition"></a></dt>
<dd><p>The key for storing the encoded edge features.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.13）">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.RadialBasisEdgeEncoding.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#RadialBasisEdgeEncoding.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.RadialBasisEdgeEncoding.forward" title="Link to this definition"></a></dt>
<dd><p>Computes the edge encoding and updates the data dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="（在 Python v3.13）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.13）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – A dictionary containing graph data.</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="（在 Python v3.13）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.13）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>Updated graph data with encoded edge features.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.ResidualBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">ResidualBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_irreps_hidden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resnet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_scalars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'e':</span> <span class="pre">'ssp',</span> <span class="pre">'o':</span> <span class="pre">'tanh'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_gates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'e':</span> <span class="pre">'ssp',</span> <span class="pre">'o':</span> <span class="pre">'abs'}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#ResidualBlock"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ResidualBlock" title="Link to this definition"></a></dt>
<dd><p>A residual block used in equivariant neural networks.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>irreps_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.13）"><em>str</em></a>) – The input irreducible representations (irreps).</p></li>
<li><p><strong>feature_irreps_hidden</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.13）"><em>str</em></a>) – The hidden feature irreps.</p></li>
<li><p><strong>resnet</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="（在 Python v3.13）"><em>bool</em></a>) – If True, apply a residual connection.</p></li>
<li><p><strong>nonlinearity_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="（在 Python v3.13）"><em>str</em></a>) – The type of nonlinearity to apply (‘gate’ or ‘norm’).</p></li>
<li><p><strong>nonlinearity_scalars</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）"><em>int</em></a><em>, </em><em>Callable</em><em>]</em>) – A dictionary mapping parity to nonlinearity functions for scalar features.</p></li>
<li><p><strong>nonlinearity_gates</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）"><em>int</em></a><em>, </em><em>Callable</em><em>]</em>) – A dictionary mapping parity to nonlinearity functions for gated features.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.ResidualBlock.create_nonlinearity">
<span class="sig-name descname"><span class="pre">create_nonlinearity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nonlinearity_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_mid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_scalars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_gates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#ResidualBlock.create_nonlinearity"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ResidualBlock.create_nonlinearity" title="Link to this definition"></a></dt>
<dd><p>Create nonlinearity module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.ResidualBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#ResidualBlock.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.ResidualBlock.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the residual block.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Input tensor with shape matching <cite>irreps_in</cite>.</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor with shape matching <cite>irreps_in</cite>.</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.SoftUnitStepCutoff">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">SoftUnitStepCutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#SoftUnitStepCutoff"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.SoftUnitStepCutoff" title="Link to this definition"></a></dt>
<dd><p>A PyTorch module that applies a soft unit step function with a cutoff.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.SoftUnitStepCutoff.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.SoftUnitStepCutoff.cutoff" title="Link to this definition"></a></dt>
<dd><p>The distance at which the cutoff is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="（在 Python v3.13）">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.SoftUnitStepCutoff.cut_param">
<span class="sig-name descname"><span class="pre">cut_param</span></span><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.SoftUnitStepCutoff.cut_param" title="Link to this definition"></a></dt>
<dd><p>A learnable parameter influencing the softness of the step.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Parameter</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.SoftUnitStepCutoff.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_distance</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#SoftUnitStepCutoff.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.SoftUnitStepCutoff.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass for the module.</p>
<p>Applies the soft unit step function to the input edge distances.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>edge_distance</strong> (<em>Tensor</em>) – A tensor containing edge distances.</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor with the calculated edge weights after applying the cutoff.</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorExpansion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">TensorExpansion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ham_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nao_max</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#TensorExpansion"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorExpansion" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorExpansion.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#TensorExpansion.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorExpansion.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass to compute the expanded tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Input tensor of shape (<a href="#id1"><span class="problematic" id="id2">*</span></a>, row.dim, col.dim).</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>Expanded tensor.</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorProductWithMemoryOptimizationWithWeight">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">TensorProductWithMemoryOptimizationWithWeight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_input_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_input_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_scalar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_MLP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_kan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#TensorProductWithMemoryOptimizationWithWeight"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorProductWithMemoryOptimizationWithWeight" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorProductWithMemoryOptimizationWithWeight.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#TensorProductWithMemoryOptimizationWithWeight.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorProductWithMemoryOptimizationWithWeight.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the TensorProductWithMemoryOptimization module.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Input tensor for the first irreps.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Input tensor for the second irreps.</p></li>
<li><p><strong>scalars</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Input tensor of scalars.</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor after applying tensor products and scaling.</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorProductWithScalarComponents">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">TensorProductWithScalarComponents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_input_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_input_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps_out</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#TensorProductWithScalarComponents"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorProductWithScalarComponents" title="Link to this definition"></a></dt>
<dd><p>A module for performing tensor products with memory optimization.</p>
<p>Parameters:
- irreps_input_1 (str): Irreducible representations for the first input.
- irreps_input_2 (str): Irreducible representations for the second input.
- irreps_out (str): Irreducible representations for the output.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorProductWithScalarComponents.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#TensorProductWithScalarComponents.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.TensorProductWithScalarComponents.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the module.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Input tensor for the first irreps.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – Input tensor for the second irreps.</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor after applying tensor products and scaling.</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.VectorToAttentionHeads">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">VectorToAttentionHeads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps_head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#VectorToAttentionHeads"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.VectorToAttentionHeads" title="Link to this definition"></a></dt>
<dd><p>Reshapes vectors of shape [N, irreps_mid] to vectors of shape [N, num_heads, irreps_head].</p>
<p>Attributes:
- num_heads (int): Number of attention heads.
- irreps_head (o3.Irreps): Irreps of each head.
- irreps_mid_in (o3.Irreps): Intermediate irreps.
- mid_in_indices (List[Tuple[int, int]]): Indices for reshaping.</p>
<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.VectorToAttentionHeads.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#VectorToAttentionHeads.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.VectorToAttentionHeads.forward" title="Link to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.
:rtype: <span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.count_neighbors_per_node">
<span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">count_neighbors_per_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#count_neighbors_per_node"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.count_neighbors_per_node" title="Link to this definition"></a></dt>
<dd><p>Calculate the number of neighbors for each node.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>source_nodes</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – A tensor containing source node indices.</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tensor where each index represents a node and the value</dt><dd><p>at that index is the count of its neighbors.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.extract_scalar_irreps">
<span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">extract_scalar_irreps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#extract_scalar_irreps"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.extract_scalar_irreps" title="Link to this definition"></a></dt>
<dd><p>Extracts and returns the scalar irreducible representations (irreps) from the given irreps.</p>
<p>A scalar irrep is defined as one with l=0 and p=1. This function calculates the total
multiplicity of such scalar irreps and constructs a new Irreps object containing only these.</p>
<p>Parameters:
- irreps (o3.Irreps): The input irreps from which to extract scalar components.</p>
<p>Returns:
- o3.Irreps: An Irreps object containing only the scalar components.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Irreps</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.filter_and_split_irreps">
<span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">filter_and_split_irreps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#filter_and_split_irreps"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.filter_and_split_irreps" title="Link to this definition"></a></dt>
<dd><p>Filters and splits irreducible representations (irreps) based on specified angular momentum range.</p>
<p>Parameters:
- irreps (o3.Irreps): The input irreducible representations.
- num_channels (int): The number of channels to split the multiplicity by.
- min_l (int): The minimum angular momentum (inclusive).
- max_l (int): The maximum angular momentum (inclusive).</p>
<p>Returns:
- o3.Irreps: The resulting irreducible representations after filtering and splitting.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Irreps</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.irreps2gate">
<span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">irreps2gate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_scalars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{-1:</span> <span class="pre">'tanh',</span> <span class="pre">1:</span> <span class="pre">'ssp'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity_gates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{-1:</span> <span class="pre">'abs',</span> <span class="pre">1:</span> <span class="pre">'ssp'}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#irreps2gate"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.irreps2gate" title="Link to this definition"></a></dt>
<dd><p>Splits irreducible representations into scalar and gated components and associates activation functions.</p>
<p>Parameters:
- irreps (o3.Irreps): The input irreducible representations.
- nonlinearity_scalars (Dict[int, str]): Activation functions for scalar components.
- nonlinearity_gates (Dict[int, str]): Activation functions for gate components.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="（在 Python v3.13）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Irreps</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Irreps</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Irreps</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="（在 Python v3.13）"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="（在 Python v3.13）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="（在 Python v3.13）"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="（在 Python v3.13）"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>]]</span></p>
</dd>
</dl>
<p>Returns:
- Tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>irreps_scalars (o3.Irreps): Scalar irreps.</p></li>
<li><p>irreps_gates (o3.Irreps): Gate irreps.</p></li>
<li><p>irreps_gated (o3.Irreps): Gated irreps.</p></li>
<li><p>act_scalars (List[Callable]): Activation functions for scalars.</p></li>
<li><p>act_gates (List[Callable]): Activation functions for gates.</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.Attention_kan.scale_irreps">
<span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.Attention_kan.</span></span><span class="sig-name descname"><span class="pre">scale_irreps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">irreps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/Attention_kan.html#scale_irreps"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.Attention_kan.scale_irreps" title="Link to this definition"></a></dt>
<dd><p>Scales the multiplicities of the irreducible representations (irreps) by a given factor,
ensuring they remain at least 1.</p>
<p>Parameters:
- irreps (o3.Irreps): The input irreps.
- factor (float): The scaling factor.</p>
<p>Returns:
- o3.Irreps: The scaled irreps.</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Irreps</span></code></span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-HamGNN_v_2_0.models.HamGNN.wigner">
<span id="wigner-py-clebsch-gordan-py"></span><h2>物理工具 (<cite>wigner.py</cite>, <cite>clebsch_gordan.py</cite>)<a class="headerlink" href="#module-HamGNN_v_2_0.models.HamGNN.wigner" title="Link to this heading"></a></h2>
<p>此模块提供了计算维格纳D矩阵 (Wigner D-matrix) 的函数。</p>
<p>维格纳D矩阵是三维空间中旋转算符在角动量本征态基矢下的矩阵表示，
在处理具有旋转对称性的物理问题（如分子轨道、张量场等）中至关重要。
此实现目前支持 l=0, 1, 2 的情况。</p>
<dl class="py function">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.wigner.wigner">
<span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.wigner.</span></span><span class="sig-name descname"><span class="pre">wigner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/wigner.html#wigner"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.wigner.wigner" title="Link to this definition"></a></dt>
<dd><p>根据旋转轴和旋转角计算维格纳D矩阵。</p>
<p>该函数为给定的角动量 <cite>l</cite> 计算一个旋转操作的不可约表示 (Irrep)。
目前仅实现了 l=0, 1, 2 的情况。</p>
<ul class="simple">
<li><p>l=0: 返回一个标量 1。</p></li>
<li><p>l=1: 使用 e3nn 库计算标准的 3x3 旋转矩阵。</p></li>
<li><p>l=2: 首先计算 l=1 的旋转矩阵 R, 然后基于 R 的元素显式构造 5x5 的D矩阵。</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）"><em>int</em></a>) – 角动量量子数，决定了表示的维度 (2l+1)。</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 一个三维向量，表示旋转轴。</p></li>
<li><p><strong>angle</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）"><em>torch.Tensor</em></a>) – 一个标量张量，表示绕轴旋转的角度（单位：弧度）。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>计算出的维格纳D矩阵，形状为 (2l+1, 2l+1)。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="（在 Python v3.13）"><strong>ValueError</strong></a> – 如果 <cite>l</cite> 不是 0, 1, 或 2，则抛出此异常。</p>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-HamGNN_v_2_0.models.HamGNN.clebsch_gordan">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.clebsch_gordan.ClebschGordan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">HamGNN_v_2_0.models.HamGNN.clebsch_gordan.</span></span><span class="sig-name descname"><span class="pre">ClebschGordan</span></span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/clebsch_gordan.html#ClebschGordan"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.clebsch_gordan.ClebschGordan" title="Link to this definition"></a></dt>
<dd><p>一个用于加载、存储和提供 Clebsch-Gordan (CG) 系数的辅助类。</p>
<p>CG系数在耦合角动量理论中至关重要，用于将两个角动量的状态分解为总角动量的状态。
这个类从一个预先计算好的 <cite>.npz</cite> 文件中加载 CG 系数张量。由于原始文件
只存储了满足 l1 &lt;= l2 &lt;= l3 的系数以减少冗余，该类在初始化时会
自动生成所有可能的 (l1, l2, l3) 排列组合，并将它们注册为 PyTorch 的
缓冲区 (buffers)，以便高效访问。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>该类继承自 <cite>torch.nn.Module</cite>，这使得它可以被无缝集成到任何
PyTorch 模型中，并且通过 <cite>register_buffer</cite> 注册的张量会自动
随模型移动到正确的设备 (如 CPU 或 GPU)。</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">(动态)</span> <span class="pre">cg_l1_l2_l3</span></span></dt>
<dd><p>注册的 CG 系数张量。例如，<cite>self.cg_1_1_2</cite> 存储了耦合 l1=1 和 l2=1
得到 l3=2 的 CG 系数。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="HamGNN_v_2_0.models.HamGNN.clebsch_gordan.ClebschGordan.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/HamGNN_v_2_0/models/HamGNN/clebsch_gordan.html#ClebschGordan.forward"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#HamGNN_v_2_0.models.HamGNN.clebsch_gordan.ClebschGordan.forward" title="Link to this definition"></a></dt>
<dd><p>获取指定角动量组合的 Clebsch-Gordan 系数张量。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）"><em>int</em></a>) – 第一个角动量的量子数。</p></li>
<li><p><strong>l2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）"><em>int</em></a>) – 第二个角动量的量子数。</p></li>
<li><p><strong>l3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="（在 Python v3.13）"><em>int</em></a>) – 耦合后的总角动量的量子数。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>对应于 (l1, l2, l3) 组合的 CG 系数张量。</p>
</dd>
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="（在 PyTorch v2.7）">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="model_structure.html" class="btn btn-neutral float-left" title="模型顶层结构" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="model_components.html" class="btn btn-neutral float-right" title="模型通用组件" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2025, HamGNN Team。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>